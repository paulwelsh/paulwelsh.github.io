<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="1179" MadCap:lastWidth="754">
    <head>
        <link href="../Resources/TableStyles/Rows.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <h2><a name="Embedded_SDKReference_1955650137_447478"></a><a name="Embedded_SDKReference_1955650137_68600"></a>eWeb_PurchaseEx</h2>
        <p>
            <MadCap:keyword term="eWeb_PurchaseEx" />Invokes the Embedded Web Store Engine to perform a purchase. This call extends the functionality of the simple purchase call (<span class="strong">eWeb_Purchase</span>). This will allow for using prefill data that can be related to individual SKUs, by placing SKUs in the cart, passing activation IDs for SKUs and so on. See <MadCap:xref href="SDK2_ActiveX_PrefAttr.htm#Embedded_SDKReference_1955650137_496611" target="" title="" alt="">eWeb_AddPrefillData</MadCap:xref> for more details on prefill data.</p>
        <h4>Required Files</h4>
        <ul>
            <li>eWebControl365.dll<br />Registered and typically located in the eSellerate directory noted at <MadCap:xref href="SDK2_ActiveX_Installing.htm#Embedded_SDKReference_1955650137_689330" target="" title="" alt="">Installing eWebControl365.dll</MadCap:xref> (the recommended location). It may be already placed here by another eSellerate-enabled application.</li>
            <li>eWebClient.dll<br />Located in the eSellerate directory noted at <MadCap:xref href="SDK2_ActiveX_DefLoc.htm#Embedded_SDKReference_1955650137_562926" target="" title="" alt="">Default Locations for eWebClient.dll</MadCap:xref>. It may be already be placed here by another eSellerate-enabled application.</li>
        </ul>
        <h4>Definition</h4>
        <p class="pwDefinition">Integer <span class="strong">eWeb_PurchaseEx</span> ( <i>esellerID, previewID, layoutCertificate, PrefillData, resultData</i> )</p>
        <p class="pwDefinition"><i>esellerID</i> – eSeller ID code</p>
        <p class="pwDefinition"><i>previewID</i> – Preview Certificate string (optional)</p>
        <p class="pwDefinition"><i>layoutCertificate</i> – Layout Test Certificate string (optional)</p>
        <p class="pwDefinition"><i>PrefillData</i> – reference to eWebPrefillData object        </p>
        <p class="pwDefinition"><i>resultData</i> – reference to eWebResultData object</p>
        <p>
            <br />For a listing of all eSellerate variables that Embedded Web Store eSellers can prefill or pull from result data, use the following URL: <a><a href="http://publishers.esellerate.net/embeddedvar.aspx" target="_blank">http://publishers.esellerate.net/embeddedvar.aspx</a></a>.</p>
        <p>See <MadCap:xref href="SDK2_ActiveX_RetVal.htm#Embedded_SDKReference_1955650137_507432" target="" title="" alt="">eSellerate Return Values</MadCap:xref> for details on return values.</p>
        <table style="caption-side: bottom;margin-left: 0;margin-right: auto;mc-table-style: url('../Resources/TableStyles/Rows.css');" class="TableStyle_Rows" cellspacing="0">
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading"><b>Parameter</b>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading"><b>Description</b>
                        </p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody_Italic"><i>esellerID</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Embedded Web Store ID, as found on the Sales Manager Embedded Web Store eSeller Summary page. Required.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColSep">
                        <p class="CellBody_Italic"><i>previewID</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Preview Certificate, as found on the Sales Manager Embedded Web Store eSeller Summary page. Required to purchase in Preview mode. Pass "" in Active mode. If the Preview Certificate passed here does not match the Preview Certificate on the Sales Manager Embedded Web Store eSeller Summary page, the purchase will be Active. This means that you can clear the Preview Certificate in the Sales Manager to activate the eSeller without having to recompile your application.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody_Italic"><i>layoutCertificate</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Layout Test Certificate, as found on the Settings tab of the Custom Layout Detail page. Allows testing of unpublished Custom Layouts. May be "". If the Layout Test Certificate passed here does not match the one on the Settings tab of the Custom Layout Detail page, the eSeller will use the published version of the Custom Layout. This means that you can clear the Layout Test Certificate in the Sales Manager to use the published layout without having to recompile your application.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColSep">
                        <p class="CellBody_Italic"><i>PrefillData</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>eWebPrefillData object passed by reference. Required.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody_Italic"><i>resultData</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColEnd">
                        <p>
                            <o>eWebResultData object passed by reference. Required.</o>
                        </p>
                    </td>
                </tr>
            </tbody>
            <caption>Parameters for eWeb_PurchaseEx Function
            </caption>
        </table>
        <h4>Example</h4>
        <p class="pwSDKCodeSamples">Dim esellerate As eWebSDKLib.eWebSDK</p>
        <p class="pwSDKCodeSamples">Dim resultData As eWebSDKLib.eWebResultData</p>
        <p class="pwSDKCodeSamples">Dim prefillData As eWebSDKLib.eWebPrefillData</p>
        <p class="pwSDKCodeSamples">Dim result As eWebSDKLib.eWeb_ReturnValues</p>
        <p class="pwSDKCodeSamples">&#160;</p>
        <p class="pwSDKCodeSamples">esellerate = CreateObject("eWebSDK.365") 'Create the Embedded Web Store control</p>
        <p class="pwSDKCodeSamples">resultData = CreateObject("eWebResultData.365") 'Create the Result Data</p>
        <p class="pwSDKCodeSamples">prefillData = CreateObject("eWebPrefillData.365") 'Create the Prefill Data</p>
        <p class="pwSDKCodeSamples">&#160;</p>
        <p class="pwSDKCodeSamples">' EXAMPLE ON HOW TO PREFILL SKU AND ACTIVATION ID </p>
        <p class="pwSDKCodeSamples">result = prefillData.eWeb_AddPrefillData("_CartItem0.SkuRefNum", "SKU862610260")</p>
        <p class="pwSDKCodeSamples">result = prefillData.eWeb_AddPrefillData("_CartItem0.ActivationID", "ACT123456789:QTNCLL-AVKJ-A73C62-EXPN-ECEBTK-89U5R0-VN2D-FCDW7J-UVTA-B1PHCA")</p>
        <p class="pwSDKCodeSamples">' PREFILL ANY OTHER ITEMS HERE</p>
        <p class="pwSDKCodeSamples">&#160;</p>
        <p class="pwSDKCodeSamples">result = esellerate.eWeb_PurchaseEx("STR9199856688", "NzIk6XXD", "", prefillData, resultData)</p>
        <p class="pwSDKCodeSamples">' TO DO: handle error or utilize result data </p>
        <p class="pwSDKCodeSamples">&#160;</p>
        <p class="pwSDKCodeSamples">prefillData = Nothing</p>
        <p class="pwSDKCodeSamples">resultData = Nothing</p>
        <p class="pwSDKCodeSamples">esellerate = Nothing</p>
    </body>
</html>