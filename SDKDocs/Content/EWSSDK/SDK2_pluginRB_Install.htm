<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="1187" MadCap:lastWidth="678">
    <head>
        <link href="../Resources/TableStyles/Rows.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <h2><a name="Embedded_SDKReference_1955650137_703711"></a><a name="Embedded_SDKReference_1955650137_67682"></a>InstallEngine</h2>
        <p>
            <MadCap:keyword term="InstallEngine" />Because there are a few differences in how you would use this function for Macintosh versus Windows targets, separate descriptions follow.</p>
        <h5>Macintosh targets</h5>
        <p>Copies the eSellerate Embedded Web Store Engine (EWSMac.framework) from the path specified to the proper location on the user's machine. This location will be /Library/Frameworks if the user has write access; otherwise the location will be <span class="_Override" style="font-family: 'Times New Roman';">~</span>/Library/Frameworks. Replaces an older version of the engine if one is present.</p>
        <p>Before you call this function, you will need to place the engine somewhere that will make it available for copying. If your application is a bundle, we recommend including the engine in your application's resources. For a single-file application, you can use an installer, a disk image, or some other method to place the engine on the user's machine alongside the application.</p>
        <p>This function requires an absolute path to the engine. The engine that you reference in the path can be either the compressed version (EWSMacCompress.tar.gz) or the non-compressed version (EWSMac.framework). In either instance, the <span class="strong">InstallEngine</span> function will install a non-compressed version of the engine to its proper location.</p>
        <p>You should not link the engine into your application. The reason is that ewsPlugin.rbx will load the engine dynamically when you call an Embedded Web Store invoking function such as <span class="strong">Purchase</span> or <span class="strong">CheckForUpdate</span>.</p>
        <h5>Windows targets</h5>
        <p>Copies the eSellerate Embedded Web Store Engine (eWebClient.dll) from the path specified to the proper location on the user's machine. Replaces an older version of the engine if one is present. See also <MadCap:xref href="SDK2_pluginRB_DefLoc.htm#Embedded_SDKReference_1955650137_703616" target="" title="" alt="">Default locations for eWebClient.dll</MadCap:xref>.</p>
        <p>Before you call this function, you will need to place the engine somewhere that will make it available for copying. For example, you can use an installer or some other method to place the engine on the user's machine alongside the application.</p>
        <p>This function requires a path to the engine. The engine that you reference in the path can be either the compressed version (eWebCompress.cab) or the non-compressed version (eWebClient.dll). In either instance, the <span class="strong">InstallEngine</span> function will install a non-compressed version of the engine to its proper location.</p>
        <h4>Required Files</h4>
        <ul>
            <li>ewsPlugin.rbx<br />Located in the REALbasic/Plugins folder.</li>
        </ul>
        <h5>Macintosh targets</h5>
        <ul>
            <li>EWSMacCompress.tar.gz or EWSMac.framework<br />Included in the development project.</li>
        </ul>
        <h5>Windows targets</h5>
        <ul>
            <li>eWebCompress.cab or eWebClient.dll<br />Included in the development project.</li>
        </ul>
        <h4>Definition</h4>
        <p class="pwDefinition"><span class="strong">InstallEngine</span> ( <i>path </i>) as Integer</p>
        <p class="pwDefinition"><i>path </i>as String – string that locates the engine to install</p>
        <p>
            <br />See <MadCap:xref href="SDK2_pluginRB_RetVal.htm#Embedded_SDKReference_1955650137_696500" target="" title="" alt="">eSellerate Return Values</MadCap:xref> for details on return values.</p>
        <table style="caption-side: bottom;margin-left: 0;margin-right: auto;mc-table-style: url('../Resources/TableStyles/Rows.css');" class="TableStyle_Rows" cellspacing="0">
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading" style="font-weight: bold;">Parameter</p>
                    </td>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading"><b>Description</b>
                        </p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody_Italic"><i>path</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">A path string that locates the engine to install. Must be an absolute path for Macintosh targets. Can be an absolute path or a relative path for Windows targets. Required.</p>
                    </td>
                </tr>
            </tbody>
            <caption>Parameters for InstallEngine Function
            </caption>
        </table>
        <p class="pwNote"><b>Tip</b>: For the best protection against engine tampering, you should compile your application with the latest ewsPlugin.rbx, and place the latest eSellerate Embedded Web Store Engine where it will be available for installing from a specified path. Next, use the API call <span class="strong">InstallEngine</span> immediately before any call that requires the engine. Calling <span class="strong">InstallEngine</span> replaces an altered engine, if one is present.</p>
        <h4>Example</h4>
        <p class="pwSDKCodeSamples">dim eSellerate as eStore</p>
        <p class="pwSDKCodeSamples">dim resultCode as Integer</p>
        <p class="pwSDKCodeSamples">eSellerate = new eStore</p>
        <p class="pwSDKCodeSamples">resultCode = eSellerate.InstallEngine(@"/Applications/geckosoft/Contents/Resources/EWSMacCompress.tar.gz")</p>
        <p class="pwSDKCodeSamples">' ** TO DO: handle error, or use the eSellerate Embedded Web Store Engine **</p>
    </body>
</html>