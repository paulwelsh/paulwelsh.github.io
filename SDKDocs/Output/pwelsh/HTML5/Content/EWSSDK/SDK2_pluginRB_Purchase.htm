<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="no-feedback" data-mc-search-type="Stem" data-mc-help-system-file-name="SDK_Home.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="eSellerate Embedded Web Store SDK|eWeb Plug-in for REALbasic">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Purchase</title>
        <script type="text/javascript">/* <![CDATA[ */

			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-6362037-19']);
			_gaq.push(['_trackPageview']);

			(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		/* ]]> */</script>
        <link href="../Resources/TableStyles/Rows.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/StylesHTML5.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <h2><a name="Embedded_SDKReference_1955650137_695666"></a><a name="Embedded_SDKReference_1955650137_23563"></a>Purchase</h2>
        <p><a name="kanchor91"></a>Invokes the Embedded Web Store Engine to perform a purchase.</p>
        <h4>Required Files</h4>
        <ul>
            <li value="1">ewsPlugin.rbx<br />Located in the REALbasic/Plugins folder.</li>
        </ul>
        <h5>Macintosh targets</h5>
        <ul>
            <li value="1">EWSMac.framework<br />Typically located in the /Library/Frameworks folder, but in some cases will be located in the <span class="_Override" style="font-family: 'Times New Roman';">~</span>/Library/Frameworks folder. It may be already placed in one or both of these locations by another eSellerate-enabled application.</li>
        </ul>
        <h5>Windows targets</h5>
        <ul>
            <li value="1">eWebClient.dll<br />Located in the eSellerate directory noted at <a href="SDK2_pluginRB_DefLoc.htm#Embedded_SDKReference_1955650137_703616" title="" alt="" class="MCXref xref">Default Locations for eWebClient.dll</a>. It may be already be placed here by another eSellerate-enabled application.</li>
        </ul>
        <h4>Definition</h4>
        <p class="pwDefinition"><span class="strong">Purchase</span> ( <i>esellerID</i> ) as Integer</p>
        <p class="pwDefinition"><i>esellerID </i>as String â€“ eSeller ID code</p>
        <p>
            <br />See <a href="SDK2_pluginRB_RetVal.htm#Embedded_SDKReference_1955650137_696500" title="" alt="" class="MCXref xref">eSellerate Return Values</a> for details on return values.</p>
        <table style="caption-side: bottom;mc-table-style: url('../Resources/TableStyles/Rows.css');margin-left: 0;margin-right: auto;" class="TableStyle_Rows" cellspacing="0">
            <caption>Parameters for Purchase Function
            </caption>
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading"><b>Parameter</b>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading"><b>Description</b>
                        </p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody_Italic"><i>esellerID</i>
                        </p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Embedded Web Store ID, as found on the Sales Manager Embedded Web Store eSeller Summary page. Required.</o>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table style="caption-side: bottom;margin-left: 0;margin-right: auto;mc-table-style: url('../Resources/TableStyles/Rows.css');" class="TableStyle_Rows" cellspacing="0">
            <caption>Options for Purchase Function
            </caption>
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading" style="font-weight: bold;">Option Name</p>
                    </td>
                    <td class="TableStyle_Rows_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading"><b>Description</b>
                        </p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">"SkuRefNum"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">String containing the SKU RefNum, <o>as found on the Sales Manager Embedded Web Store SKU Attributes page. </o>Causes the Embedded Web Store to add the referenced SKU to the shopping cart and display the cart page. May be "", in which case the Embedded Web Store will display the catalog page. For information on assigning the store layout's cart and catalog pages, see "Custom Layouts: Files tab" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">"PreviewID"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Preview Certificate, as found on the Sales Manager Embedded Web Store eSeller Summary page. Required to purchase in Preview mode. Pass "" in Active mode. If the Preview Certificate passed here does not match the Preview Certificate on the Sales Manager Embedded Web Store eSeller Summary page, the purchase will be Active. This means that you can clear the Preview Certificate in the Sales Manager to activate the eSeller without having to recompile your application.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">"LayoutCertificate"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">
                            <o>String containing the Layout Test Certificate, as found on the Settings tab of the Custom Layout Detail page. Allows testing of unpublished Custom Layouts. May be "". If the Layout Test Certificate passed here does not match the one on the Settings tab of the Custom Layout Detail page, the eSeller will use the published version of the Custom Layout. This means that you can clear the Layout Test Certificate in the Sales Manager to use the published layout without having to recompile your application.</o>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">"TrackingID"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">String containing special information that marks the function call so that it can be tracked in reports. May be "". &#160;See "tracking IDs" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">"AffiliateID"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">String containing an affiliate ID that marks the function call so that it can be tracked in reports. May be "". For information on the eSellerate Affiliates program, see "eSellerate Affiliates: joining" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">"CouponID"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">String containing a coupon ID that enables coupon discounts on qualified purchases. May be "". See "coupons: creating" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">"ActivationID"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">String containing an activation ID for use in eSellerate Product Activation. May be "". Automatic activation occurs if the Embedded Web Store Engine completes the action and returns a unique serial number for use with the ActivationID<i><![CDATA[ ]]></i>(barring any activation errors). See "Product Activation: setting up" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                        <p class="CellBody">When you pass a value other than "" for the ActivationID option, you must also pass a value other than "" for the SkuRefNum<i><![CDATA[ ]]></i>option. The SkuRefNum specifies the SKU whose serial number should be activated according to the rules set by ActivationID.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Rows_Body_1_0_RowEnd_ColSep">
                        <p class="CellBody">"ExtraData"</p>
                    </td>
                    <td class="TableStyle_Rows_Body_1_0_RowEnd_ColEnd">
                        <p class="CellBody">String containing special additional information needed for serial number generation. Required for serial number type option <span class="strong">Application Supplied</span> and optional for <span class="strong">Standard</span>, <span class="strong">Standard Enhanced</span> and <span class="strong">Armadillo</span>. For all other serial number type options, pass NULL. See "serial numbers: Serial Number Type options" in the eSellerate <MadCap:conditionalText data-mc-conditions="Primary.Online">Publishers Help</MadCap:conditionalText> index.</p>
                        <p class="CellBody">When you pass a value other than "" for the ExtraData option, you must also pass a value other than "" for the SkuRefNum option. The SkuRefNum specifies the SKU that should use the additional serial number information provided by ExtraData.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="pwNote"><span class="strong">Note</span>: Options are set by <span class="strong">SetOption</span>. See <a href="SDK2_pluginRB_SetOpt.htm#Embedded_SDKReference_1955650137_695935" title="" alt="" class="MCXref xref">SetOption</a>.<br /></p>
        <h4>Example</h4>
        <p class="pwSDKCodeSamples">dim eSellerate as eStore</p>
        <p class="pwSDKCodeSamples">dim resultCode as Integer</p>
        <p class="pwSDKCodeSamples">eSellerate = new eStore</p>
        <p class="pwSDKCodeSamples">resultCode = eSellerate.Purchase("STR9199856688")</p>
        <p class="pwSDKCodeSamples">' ** TO DO: handle error, or utilize results **</p>
        <p>&#160;</p>
    </body>
</html>